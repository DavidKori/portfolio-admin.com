import{r as t,t as r,j as e}from"./index-DN2QgEtp.js";import{F as j}from"./FormField-BPRme1e3.js";import{M as A}from"./MediaUploader-WpIDh3c1.js";import{C as I}from"./ConfirmModal-87vAIZv7.js";import{u as _}from"./useToast-C_6R7hpL.js";/* empty css                */const J=()=>{const[N,c]=t.useState([]),[i,b]=t.useState(null),[v,n]=t.useState(!1),[U,C]=t.useState(!0),[S,u]=t.useState(!1),[h,y]=t.useState(null),[g,T]=t.useState(!1),{showSuccess:d,showError:p}=_(),[l,f]=t.useState({name:"",role:"",message:"",imageUrl:""});t.useEffect(()=>{F()},[]);const F=async()=>{try{const s=await r.getAll();c(s.data||[])}catch(s){console.error("Failed to fetch testimonials:",s)}finally{C(!1)}},m=(s,a)=>{f(o=>({...o,[s]:a}))},D=async s=>{T(!0);try{const a=await r.uploadImage(s);return m("imageUrl",a.data.url),d("Profile image uploaded successfully"),a.data}catch(a){throw p("Failed to upload image"),a}finally{T(!1)}},k=async s=>{s.preventDefault();try{if(i){const a=await r.update(i._id,l);c(o=>o.map(w=>w._id===i._id?a.data:w)),d("Testimonial updated successfully")}else{const a=await r.create(l);c(o=>[...o,a.data]),d("Testimonial added successfully")}x(),n(!1)}catch{p("Failed to save testimonial")}},E=s=>{b(s),f({name:s.name,role:s.role,message:s.message,imageUrl:s.imageUrl||""}),n(!0)},M=async()=>{if(h)try{await r.delete(h._id),c(s=>s.filter(a=>a._id!==h._id)),d("Testimonial deleted successfully")}catch{p("Failed to delete testimonial")}finally{y(null),u(!1)}},x=()=>{f({name:"",role:"",message:"",imageUrl:""}),b(null)};return U?e.jsx("div",{className:"section-loading",children:"Loading testimonials..."}):e.jsxs("div",{className:"section-container",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Testimonials"}),e.jsx("p",{children:"Manage reviews and feedback from clients and colleagues"})]}),e.jsxs("div",{className:"section-content",children:[e.jsx("div",{className:"section-actions",children:e.jsx("button",{className:"btn-primary",onClick:()=>{x(),n(!0)},children:"+ Add Testimonial"})}),v&&e.jsxs("div",{className:"form-card",children:[e.jsx("h2",{children:i?"Edit Testimonial":"Add New Testimonial"}),e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"grid-2",children:[e.jsx(j,{label:"Person's Name",value:l.name,onChange:s=>m("name",s),required:!0,placeholder:"e.g., John Smith"}),e.jsx(j,{label:"Role/Position",value:l.role,onChange:s=>m("role",s),required:!0,placeholder:"e.g., Project Manager at Google"})]}),e.jsx(j,{label:"Testimonial Message",value:l.message,onChange:s=>m("message",s),multiline:!0,rows:4,placeholder:"Their feedback about working with you...",required:!0}),e.jsx(A,{label:"Profile Image (Optional)",onUpload:D,accept:"image/*",existingUrl:l.imageUrl,helperText:"Upload the person's profile picture"}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{n(!1),x()},disabled:g,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:g,children:g?"Uploading...":i?"Update":"Create"})]})]})]}),e.jsx("div",{className:"items-grid",children:N.map(s=>e.jsxs("div",{className:"item-card testimonial-card",children:[e.jsxs("div",{className:"testimonial-content",children:[e.jsx("div",{className:"testimonial-quote",children:'"'}),e.jsx("p",{className:"testimonial-message",children:s.message})]}),e.jsxs("div",{className:"testimonial-author",children:[e.jsx("div",{className:"author-image",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name}):e.jsx("div",{className:"author-initials",children:s.name.split(" ").map(a=>a[0]).join("")})}),e.jsxs("div",{className:"author-info",children:[e.jsx("div",{className:"author-name",children:s.name}),e.jsx("div",{className:"author-role",children:s.role})]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsx("button",{className:"btn-edit",onClick:()=>E(s),children:"Edit"}),e.jsx("button",{className:"btn-delete",onClick:()=>{y(s),u(!0)},children:"Delete"})]})]},s._id))}),N.length===0&&!v&&e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ’¬"}),e.jsx("h3",{children:"No Testimonials Yet"}),e.jsx("p",{children:"Add feedback from clients and colleagues to build trust"}),e.jsx("button",{className:"btn-primary",onClick:()=>n(!0),children:"Add First Testimonial"})]})]}),e.jsx(I,{isOpen:S,onClose:()=>u(!1),onConfirm:M,title:"Delete Testimonial",message:"Are you sure you want to delete this testimonial? This action cannot be undone.",confirmText:"Delete Testimonial"})]})};export{J as default};
