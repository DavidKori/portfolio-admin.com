import{r as l,p as h,j as t,L as H}from"./index-CuGo0VHM.js";import{F as m}from"./FormField-DV9xFr-W.js";import{M as Y}from"./MediaUploader-CykmVJun.js";import{C as F}from"./ConfirmModal-D0vBWr9t.js";import{u as B}from"./useToast-CRbyvKE3.js";/* empty css                */const W=()=>{const[f,c]=l.useState([]),[p,S]=l.useState(null),[P,b]=l.useState(!1),[A,D]=l.useState(!0),[_,g]=l.useState(!1),[x,w]=l.useState(null),[y,k]=l.useState(!1),{showSuccess:n,showError:d}=B(),[M,j]=l.useState("false"),[r,T]=l.useState(""),[v,L]=l.useState({status:"draft"}),[i,U]=l.useState({title:"",description:"",techStack:"",imageUrl:"",images:[""],videoUrl:"",liveUrl:"",githubUrl:""});l.useEffect(()=>{E(),j(!1)},[]);const E=async()=>{try{const e=await h.getAll();c(Array.isArray(e?.data)?e.data:[])}catch(e){console.error("Failed to fetch projects:",e),d("Failed to load projects"),c([])}finally{D(!1)}},o=(e,s)=>{U(a=>({...a,[e]:s}))},I=async e=>{k(!0);try{const s=await h.uploadMedia(e);return o("imageUrl",s.data.url),n("Image uploaded successfully"),s.data}catch(s){throw d("Failed to upload image"),s}finally{k(!1)}},R=async e=>{e.preventDefault();const s={...i,techStack:i.techStack?i.techStack.split(",").map(a=>a.trim()).filter(a=>a):[]};try{if(p){const a=await h.update(p._id,s);c(u=>u.map(C=>C._id===p._id?a.data:C)),n("Project updated successfully")}else{const a=await h.create(s);c(u=>[...u,a.data]),n("Project added successfully")}N(),b(!1)}catch(a){console.error("Failed to save project:",a),d("Failed to save project")}},O=e=>{S(e),U({title:e.title||"",description:e.description||"",techStack:Array.isArray(e.techStack)?e.techStack.join(", "):"",imageUrl:e.imageUrl||"",videoUrl:e.videoUrl||"",liveUrl:e.liveUrl||"",githubUrl:e.githubUrl||""}),b(!0)},q=async()=>{if(x)try{await h.delete(x._id),c(e=>e.filter(s=>s._id===x._id)),n("Project deleted successfully")}catch(e){console.error("Failed to delete project:",e),d("Failed to delete project")}finally{w(null),g(!1)}},G=async()=>{if(!r)return;r.status;const e=v.status==="draft"||v.status!=="published"?"published":"draft";L({status:e});try{const s=await h.update(r._id,v);c(a=>a.map(u=>u._id===r._id?s.data:u)),s.data.status==="published"?n("Project published successfully"):n("Project unpublished successfully")}catch(s){console.error(response.data.status==="published"?"Failed to unpublish project":"Failed to publish project",s),response.data.status==="published"?d("Failed to unpublish project"):d("Failed to publish project")}finally{j(!1)}},N=()=>{U({title:"",description:"",techStack:"",imageUrl:"",videoUrl:"",liveUrl:"",githubUrl:""}),S(null)};return A?t.jsx(H,{text:"Loading projects..."}):t.jsxs("div",{className:"section-container",children:[t.jsxs("div",{className:"section-header",children:[t.jsx("h1",{children:"Projects Management"}),t.jsx("p",{children:"Manage your portfolio projects"})]}),t.jsxs("div",{className:"section-content",children:[t.jsx("div",{className:"section-actions",children:t.jsx("button",{className:"btn-primary",onClick:()=>{N(),b(!0)},children:"+ Add New Project"})}),P&&t.jsxs("div",{className:"form-card",children:[t.jsx("h2",{children:p?"Edit Project":"Add New Project"}),t.jsxs("form",{onSubmit:R,children:[t.jsx(m,{label:"Title",value:i.title,onChange:e=>o("title",e),required:!0,placeholder:"Project title"}),t.jsx(m,{label:"Description",value:i.description,onChange:e=>o("description",e),multiline:!0,rows:4,placeholder:"Project description",required:!0}),t.jsx(m,{label:"Tech Stack (comma separated)",value:i.techStack,onChange:e=>o("techStack",e),placeholder:"React, Node.js, MongoDB",helperText:"Separate technologies with commas"}),t.jsx(Y,{label:"Project Image",onUpload:I,accept:"image/*",existingUrl:i.imageUrl}),t.jsx(m,{label:"Video URL (optional)",type:"url",value:i.videoUrl,onChange:e=>o("videoUrl",e),placeholder:"https://youtube.com/watch?v=..."}),t.jsx(m,{label:"Live URL (optional)",type:"url",value:i.liveUrl,onChange:e=>o("liveUrl",e),placeholder:"https://project-live-demo.com"}),t.jsx(m,{label:"GitHub URL (optional)",type:"url",value:i.githubUrl,onChange:e=>o("githubUrl",e),placeholder:"https://github.com/username/project"}),t.jsxs("div",{className:"form-actions",children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{b(!1),N()},disabled:y,children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:y,children:y?"Uploading...":p?"Update":"Create"})]})]})]}),t.jsx("div",{className:"items-grid",children:Array.isArray(f)&&f.length>0?f.map(e=>t.jsxs("div",{className:"item-card",children:[e.imageUrl&&t.jsx("div",{className:"item-image",children:t.jsx("img",{src:e.imageUrl,alt:e.title||"Project image"})}),t.jsxs("div",{className:"item-content",children:[t.jsx("h3",{className:"item-title",children:e.title||"Untitled Project"}),t.jsx("p",{className:"item-description",children:e.description?e.description.length>150?`${e.description.substring(0,150)}...`:e.description:"No description provided"}),Array.isArray(e.techStack)&&e.techStack.length>0&&t.jsx("div",{className:"item-tech",children:e.techStack.map((s,a)=>t.jsx("span",{className:"tech-tag",children:s},a))}),t.jsxs("div",{className:"item-links",children:[e.liveUrl&&t.jsx("a",{href:e.liveUrl,target:"_blank",rel:"noopener noreferrer",className:"project-link",children:"ðŸŒ Live Demo"}),e.githubUrl&&t.jsx("a",{href:e.githubUrl,target:"_blank",rel:"noopener noreferrer",className:"project-link",children:"ðŸ’» GitHub"})]}),t.jsxs("div",{className:"item-actions",children:[t.jsx("button",{className:"btn-edit",onClick:()=>O(e),children:"Edit"}),t.jsx("button",{className:"btn-delete",onClick:()=>{w(e),g(!0)},children:"Delete"}),t.jsx("button",{className:"btn-edit",onClick:()=>{T(e),j(!0)},children:e.status==="draft"?"publish":"unpublish"})]})]})]},e._id||e.id)):!P&&t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-icon",children:"ðŸ“‚"}),t.jsx("h3",{children:"No Projects Yet"}),t.jsx("p",{children:"Add your first project to showcase in your portfolio"}),t.jsx("button",{className:"btn-primary",onClick:()=>b(!0),children:"Add First Project"})]})})]}),t.jsx(F,{isOpen:_,onClose:()=>g(!1),onConfirm:q,title:"Delete Project",message:"Are you sure you want to delete this project? This action cannot be undone.",confirmText:"Delete Project"}),t.jsx(F,{isOpen:M,onClose:()=>j(!1),onConfirm:G,title:r.status==="draft"?"publish project":"unpublish project",message:r.status==="draft"?"when you publish it will show in the client side":"when you unpublish only YOU will be able to see the project",confirmText:r.status==="draft"?"publish":"unpublish"})]})};export{W as default};
